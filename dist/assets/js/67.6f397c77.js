(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{143:function(t,s,a){t.exports=a.p+"assets/img/code-splitting.d0157e4d.png"},144:function(t,s,a){t.exports=a.p+"assets/img/lazy.dce3fe2f.png"},216:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"代码分割"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码分割","aria-hidden":"true"}},[this._v("#")]),this._v(" 代码分割")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("即使分离构建包可以在一定的程度上缓解这个问题，但它不是唯一的解决方案，你最终仍然需要下载大量数据。幸运的是，使用"),s("strong",[this._v("代码分割")]),this._v("这个技术可以更好的解决这个问题。它允许在你需要时动态地加载代码。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("顺便说一下，使用webpack的懒加载可以实现Google的[PRPL模式]（https://developers.google.com/web/fundamentals/performance/prpl-pattern/）。PRPL（推送，渲染，预缓存，延迟加载）的设计考虑了移动网络。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"代码分割的格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码分割的格式","aria-hidden":"true"}},[this._v("#")]),this._v(" 代码分割的格式")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("代码分割可以在webpack中以两种主要方式完成：通过动态的 "),s("code",[this._v("import")]),this._v(" 或 "),s("code",[this._v("require.ensure")]),this._v(" 语法。在此项目用前者。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("项目的目标是最终得到一个按需加载的分裂点。可以在拆分中进行拆分，你可以根据拆分构建整个应用程序。这样做的好处是，你的应用程序的初始有效负载可能会比其他情况下更小。\n"),s("img",{attrs:{src:a(143),alt:"代码分割"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"import-的动态特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import-的动态特性","aria-hidden":"true"}},[this._v("#")]),s("code",[this._v("import")]),this._v(" 的动态特性")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("[dynamic"),s("code",[this._v("import")]),this._v("语法]（https://github.com/tc39/proposal-dynamic-import）尚未在官方语言规范中。 由于这个原因，特别是在Babel设置中需要进行小的调整。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("动态的import是用 "),s("code",[this._v("Promise")]),this._v(" 定义的：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token comment"}},[t._v('/* webpackChunkName: "optional-name" */')]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"./module"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  module "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  error "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("Promise"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("all")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"lunr"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"../search_index.json"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("lunr"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" search"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    index"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" lunr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Index"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("search"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("index"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    lines"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" search"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lines"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("上面的代码为请求创建分离的包。如果只需要一个，则必须使用命名或定义中间模块来 "),s("code",[this._v("import")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("在以正确的方式配置之后，语法仅适用于JavaScript。如果你使用其他环境，则可能必须使用以下各部分中介绍的替代方案。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"配置代码分割"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置代码分割","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置代码分割")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("为了演示代码分割的想法，你可以使用动态的 "),s("code",[this._v("import")]),this._v("。项目的Babe需要额外的l配置以使语法有效。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"配置-babel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-babel","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置 Babel")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("鉴于Babel不支持开箱即用的动态 "),s("code",[this._v("import")]),this._v(" 语法，它需要[@babel/plugin-syntax-dynamic-import]（https://www.npmjs.com/package/@babel/plugin-syntax-dynamic-import）插件来工作。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("用下面的命令，添加 "),s("code",[this._v("@babel/plugin-syntax-dynamic-import")]),this._v(" 依赖：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" @babel/plugin-syntax-dynamic-import --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在 "),s("strong",[this._v(".babelrc")]),this._v(" 中添加如下配置启用动态的 "),s("code",[this._v("import")]),this._v("：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"plugins"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"@babel/plugin-syntax-dynamic-import"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("如果你正在使用ESLint，你应该在ESLint配置中安装 "),s("code",[this._v("babel-eslint")]),this._v(" 并设置 "),s("code",[this._v('parser："babel-eslint"')]),this._v(" 以及 "),s("code",[this._v("parserOptions.allowImportExportEverywhere：true")]),this._v(" 。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"用动态的-import-定义一个分割点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用动态的-import-定义一个分割点","aria-hidden":"true"}},[this._v("#")]),this._v(" 用动态的 "),s("code",[this._v("import")]),this._v(" 定义一个分割点")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("src/lazy.js")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[this._v("export")]),this._v(" "),s("span",{attrs:{class:"token keyword"}},[this._v("default")]),this._v(" "),s("span",{attrs:{class:"token string"}},[this._v('"Hello from lazy"')]),s("span",{attrs:{class:"token punctuation"}},[this._v(";")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("src/component.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Hello world"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("createElement")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"div"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("className "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"pure-button"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./lazy"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lazy "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" lazy"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("error")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" element"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果运行 "),s("code",[this._v("npm start")]),this._v(" 脚本命令，启动应用，然后单击按钮，你将看到下图所示的效果：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(144),alt:"Lazy loaded content"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果你运行 "),s("code",[this._v("npm run build")]),this._v(" 脚本命令，你将看到如下信息：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("Hash: 063e54c36163f79e8c90\nVersion: webpack 4.1.1\nTime: 3185ms\nBuilt at: 3/16/2018 5:04:04 PM\n               Asset       Size  Chunks             Chunk Names\n            0.js.map  198 bytes       0  "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("emitted"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                0.js  156 bytes       0  "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("emitted"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n             main.js    2.2 KiB       2  "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("emitted"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  main\n            main.css   1.27 KiB       2  "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("emitted"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  main\n    vendors~main.css   2.27 KiB       1  "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("emitted"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  vendors~main\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("0.js")]),this._v(" 就是你所需要的分离点。查看文件，你会发现webpack已将代码包装到 "),s("code",[this._v("webpackJsonp")]),this._v(" 块中。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("如果要调整块的名称，请设置"),s("code",[this._v("output.chunkFilename")]),this._v("。 例如，将其设置为 "),s("code",[this._v('"chunk.[id].js"')]),this._v(" 将为每个拆分块添加前缀 "),s("code",[this._v('"chunk"')]),this._v(" 。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("[bundle-loader]（https://www.npmjs.com/package/bundle-loader）可以通过loader接口实现类似的结果，它通过 "),s("code",[this._v("name")]),this._v(" 选项支持bundle重命名。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"使用react实现代码分割"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用react实现代码分割","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用React实现代码分割")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"react"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("// Somewhere in code")]),t._v("\n"),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("AsyncComponent loader"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./SomeComponent"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("AsyncComponent")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("React"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("constructor")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("super")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("componentDidMount")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("loader")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      Component "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setState")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("render")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("props "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Component "),a("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("Component "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("props"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("Placeholder "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nAsyncComponent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("propTypes "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  loader"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PropTypes"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("func"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isRequired"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Placeholder"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PropTypes"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isRequired"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"禁用代码分割"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁用代码分割","aria-hidden":"true"}},[this._v("#")]),this._v(" 禁用代码分割")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webpack "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"webpack"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  plugins"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("webpack"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("optimize"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LimitChunkCountPlugin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      maxChunks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("要实现 "),a("strong",[t._v("代码分割")]),t._v(" ，你必须决定分割什么和在哪里。通常，你会在路由器中找到良好的分裂点。或者你注意到仅在使用特定功能时，它才被需要。")]),a("li",[t._v("要使用动态"),a("code",[t._v("import")]),t._v("语法，Babel和ESLint都需要仔细调整。 Webpack支持开箱即用的语法。")]),a("li",[t._v("使用命名将分离的拆分点放入相同的构建包中。")]),a("li",[t._v("这些技术可以在框架和React等库中使用。你可以将相关逻辑包装到特定组件，用户友好的方式处理加载过程。")]),a("li",[t._v("启用代码分割，可以用 "),a("code",[t._v("webpack.optimize.LimitChunkCountPlugin")]),t._v(" 的 "),a("code",[t._v("maxChunks")]),t._v(" 配置。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("附录中的 "),s("em",[this._v("Searching with React")]),this._v(" 包含代码分割的完整示例。当用户搜索信息加载时，如何设置静态站点索引的显示。")])])}],e=a(0),o=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("p",[t._v("随着功能的演变，Web应用程序往往会越变越大，应用程序加载所需的时间也越来越长。但对用户来说体验效果就越令人沮丧。在网络速度较慢的移动环境中，此问题会被无限放大。")]),t._m(1),a("p",[t._v("你可以在用户进入应用程序的新视图时加载更多代码。你还可以将加载绑定到特定的用户操作上，例如滚动或单击按钮。你还可以尝试预测用户下一步要做什么，并根据你的猜测加载代码。这样当用户尝试访问它时，功能就已存在。")]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),a("p",[t._v("可选名称允许你将多个拆分点拉入单个包中。只要它们具有相同的名称，它们就会被分组。每个拆分点默认生成一个单独的包。")]),a("p",[t._v("接口允许组合，你可以并行加载多个资源：")]),t._m(10),t._m(11),t._m(12),a("blockquote",[a("p",[t._v("有一个旧的语法"),a("a",{attrs:{href:"https://webpack.js.org/api/module-methods/#require-ensure",target:"_blank",rel:"noopener noreferrer"}},[t._v("require.ensure"),a("OutboundLink")],1),t._v("。实际上，新语法可以涵盖相同的功能，另见[require.include]（https://webpack.js.org/api/module-methods/#require-include）。")])]),a("blockquote",[a("p",[t._v("[webpack-pwa]（https://github.com/webpack/webpack-pwa）大范围地介绍了这个思想，并讨论了不同的基于shell的方法。你可以在 "),a("a",{attrs:{href:"https://lvzhenbang.github.io/webpack-book/dist/zh/output/02_multiple_pages.html#possible-approaches",target:"_blank",rel:"noopener noreferrer"}},[a("em",[t._v("Multiple Pages")]),a("OutboundLink")],1),t._v(" 这章中将详细介绍这个主题。")])]),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),a("p",[t._v("在项目中，添加一个包含替换演示按钮文本的字符串的模块，然后演示这个想法：")]),t._m(23),t._m(24),a("p",[t._v("你还需要将应用程序指向此文件，以便应用程序知道通过单击来加载它。只要用户点击按钮，就会触发加载过程并替换内容：")]),t._m(25),t._m(26),t._m(27),t._m(28),t._m(29),t._m(30),t._m(31),t._m(32),t._m(33),a("blockquote",[a("p",[t._v("当你必须处理更复杂的分割时，"),a("a",{attrs:{href:"https://lvzhenbang.github.io/webpack-book/dist/zh/techniques/01_dynamic_loading.html#dynamic-loading-with-require-context",target:"_blank",rel:"noopener noreferrer"}},[a("em",[t._v("Dynamic Loading")]),a("OutboundLink")],1),t._v(" 这章介绍了其他技术。")])]),t._m(34),a("p",[t._v("在React组件中实现拆分模式。Airbnb使用以下[解决方案]（https://gist.github.com/lencioni/643a78712337d255f5c031bfc81ca4cf），如Joe Lencioni所述：")]),t._m(35),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/react-async-component",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-async-component"),a("OutboundLink")],1),t._v(" 包含 "),a("code",[t._v("createAsyncComponent")]),t._v(" 调用，并提供服SSR特定功能。 "),a("a",{attrs:{href:"https://www.npmjs.com/package/loadable-components",target:"_blank",rel:"noopener noreferrer"}},[t._v("loadable-components"),a("OutboundLink")],1),t._v(" 是其它一个选项。")])]),t._m(36),a("p",[t._v("虽然在一般况下代码分割是好的，但它并不是总是好的，尤其是在服务器端使用时。因此，可以像下面这样将其禁用：")]),t._m(37),a("blockquote",[a("p",[t._v("为什么代码分割在服务端使用会出现问题？，可以看 "),a("a",{attrs:{href:"https://medium.com/@glennreyes/how-to-disable-code-splitting-in-webpack-1c0b1754a3c5",target:"_blank",rel:"noopener noreferrer"}},[t._v("Glenn Reyes 的详细解释"),a("OutboundLink")],1),t._v("。")])]),t._m(38),a("p",[t._v("代码分割是一个可以进一步提升你的应用程序的功能。你可以在需要时加载代码，以获得更快的初始加载时间和改善的用户体验，尤其是在带宽有限的移动环境中。")]),a("p",[t._v("内容回顾：")]),t._m(39),a("p",[t._v("在下一章中，将介绍如何对构建做整理。")]),t._m(40)])},n,!1,null,null,null);o.options.__file="03_code_splitting.md";s.default=o.exports}}]);