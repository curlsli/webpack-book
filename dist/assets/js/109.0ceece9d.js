(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{256:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("p",[t._v("Testing is a vital part of development. Even though techniques, such as linting, can help to spot and solve issues, they have their limitations. Testing can be applied to the code and an application on many different levels.")]),t._m(1),a("p",[t._v("You can find a lot of testing tools for JavaScript. The most popular options work with webpack after you configure it right. Even though test runners work without webpack, running them through it allows you to process code the test runners do not understand while having control over the way modules are resolved. You can also use webpack's watch mode instead of relying on one provided by a test runner.")]),t._m(2),t._m(3),a("p",[a("a",{attrs:{href:"https://mochajs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mocha"),a("OutboundLink")],1),t._v(" is a popular test framework for Node. While Mocha provides test infrastructure, you have to bring your asserts to it. Even though "),a("a",{attrs:{href:"https://nodejs.org/api/assert.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node "),a("code",[t._v("assert")]),a("OutboundLink")],1),t._v(" can be enough, it works with other assertion libraries as well.")]),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/mocha-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocha-loader"),a("OutboundLink")],1),t._v(" allows running Mocha tests through webpack. "),a("a",{attrs:{href:"https://www.npmjs.com/package/mocha-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("mocha-webpack"),a("OutboundLink")],1),t._v(" is another option that aims to provide more functionality.")]),t._m(4),t._m(5),t._m(6),a("p",[t._v("{pagebreak}")]),t._m(7),a("p",[t._v("To have something to test, set up a function:")]),t._m(8),t._m(9),a("p",[t._v("Then, to test that, set up a small test suite:")]),t._m(10),t._m(11),t._m(12),a("p",[t._v("To run Mocha against the test, add a script:")]),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),a("p",[t._v("Webpack can provide similar functionality through a web interface. The hard parts of the problem have been solved earlier in this book, what remains is combining those solutions through configuration.")]),t._m(20),t._m(21),t._m(22),a("p",[t._v("A small change is required on webpack side:")]),t._m(23),t._m(24),t._m(25),a("p",[t._v("Add a helper script to make it convenient to run:")]),t._m(26),t._m(27),t._m(28),t._m(29),t._m(30),a("p",[t._v("Adjusting either the test or the code should lead to a change in the browser. You can grow your specification or refactor the code while seeing the status of the tests.")]),a("p",[t._v("Compared to the vanilla Mocha setup, configuring Mocha through webpack comes with a couple of advantages:")]),t._m(31),t._m(32),t._m(33),t._m(34),a("p",[a("a",{attrs:{href:"https://karma-runner.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Karma"),a("OutboundLink")],1),t._v(" is a test runner that allows you to run tests on real devices and "),a("a",{attrs:{href:"http://phantomjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PhantomJS"),a("OutboundLink")],1),t._v(", a headless browser. "),a("a",{attrs:{href:"https://www.npmjs.com/package/karma-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("karma-webpack"),a("OutboundLink")],1),t._v(" is a Karma preprocessor that allows you to connect Karma with webpack. The same benefits as before apply still. This time around, however, there is more control over the test environment.")]),t._m(35),t._m(36),a("p",[t._v("{pagebreak}")]),a("p",[t._v("Like webpack, Karma relies on a configuration convention as well. Set up a file as follows to make it pick up the tests:")]),t._m(37),t._m(38),a("p",[t._v("W> The setup generates a bundle per each test. If you have a large number of tests and want to improve performance, set up "),a("code",[t._v("require.context")]),t._v(" as for Mocha above. See "),a("a",{attrs:{href:"https://github.com/webpack-contrib/karma-webpack/issues/23",target:"_blank",rel:"noopener noreferrer"}},[t._v("karma-webpack issue 23"),a("OutboundLink")],1),t._v(" for more details.")]),a("p",[t._v("{pagebreak}")]),a("p",[t._v("Add an npm shortcut:")]),t._m(39),t._m(40),t._m(41),t._m(42),t._m(43),a("p",[t._v("Given running tests this way can become annoying, it's a good idea to configure alternative ways. Using PhantomJS is one option.")]),t._m(44),a("p",[t._v("{pagebreak}")]),t._m(45),a("p",[t._v("Running tests through PhantomJS requires a couple of dependencies:")]),t._m(46),a("p",[t._v("To make Karma run tests through Phantom, adjust its configuration as follows:")]),t._m(47),t._m(48),t._m(49),t._m(50),a("p",[t._v("Given running tests after the change can get boring after a while, Karma provides a watch mode.")]),a("p",[t._v("W> PhantomJS does not support ES2015 features yet, so you have to preprocess the code for tests using them. ES2015 support is planned for PhantomJS 2.5.")]),t._m(51),a("p",[t._v("Accessing Karma's watch mode is possible as follows:")]),t._m(52),t._m(53),t._m(54),t._m(55),a("p",[t._v("To know how much of the code the tests cover, it can be a good idea to generate coverage reports. Doing this requires code-level instrumentation. Also, the added information has to be reported and can be done through HTML and LCOV reports.")]),a("p",[t._v("T> LCOV integrates well with visualization services. You can send coverage information to an external service through a continuous integration environment and track the status in one place.")]),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/isparta",target:"_blank",rel:"noopener noreferrer"}},[t._v("isparta"),a("OutboundLink")],1),t._v(" is a popular, ES2015 compatible code coverage tool. Connecting it with Karma requires configuration. Most importantly the code has to be instrumented through "),a("a",{attrs:{href:"https://www.npmjs.com/package/babel-plugin-istanbul",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-plugin-istanbul"),a("OutboundLink")],1),t._v(". Doing this requires a small amount of webpack configuration as well due to the setup. "),a("a",{attrs:{href:"https://www.npmjs.com/package/karma-coverage",target:"_blank",rel:"noopener noreferrer"}},[t._v("karma-coverage"),a("OutboundLink")],1),t._v(" is required for the reporting portion of the problem.")]),a("p",[t._v("{pagebreak}")]),a("p",[t._v("Install the dependencies first:")]),t._m(56),a("p",[t._v("Connect the Babel plugin so that the instrumentation happens when Karma is run:")]),t._m(57),t._m(58),a("p",[t._v("Make sure to set Babel environment, so it picks up the plugin:")]),t._m(59),t._m(60),t._m(61),t._m(62),t._m(63),t._m(64),t._m(65),t._m(66),t._m(67),a("p",[t._v("LCOV requires specific tooling to work. You can find editor plugins such as "),a("a",{attrs:{href:"https://atom.io/packages/lcov-info",target:"_blank",rel:"noopener noreferrer"}},[t._v("lcov-info"),a("OutboundLink")],1),t._v(" for Atom. A correctly configured plugin can give you coverage information while you are developing using the watch mode.")]),t._m(68),t._m(69),a("p",[t._v("Facebook's "),a("a",{attrs:{href:"https://facebook.github.io/jest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jest"),a("OutboundLink")],1),t._v(" is an opinionated alternative that encapsulates functionality, including coverage and mocking, with minimal setup. It can capture snapshots of data making it valuable for projects where you have the behavior you would like to record and retain.")]),a("p",[t._v("Jest tests follow "),a("a",{attrs:{href:"https://www.npmjs.com/package/jasmine",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jasmine"),a("OutboundLink")],1),t._v(" test framework semantics, and it supports Jasmine-style assertions out of the box. Especially the suite definition is close enough to Mocha so that the current test should work without any adjustments to the test code itself. Jest provides "),a("a",{attrs:{href:"https://www.npmjs.com/package/jest-codemods",target:"_blank",rel:"noopener noreferrer"}},[t._v("jest-codemods"),a("OutboundLink")],1),t._v(" for migrating more complicated projects to Jest semantics.")]),a("p",[t._v("Install Jest first:")]),t._m(70),a("p",[t._v("Jest captures tests through "),a("em",[t._v("package.json")]),a("a",{attrs:{href:"https://facebook.github.io/jest/docs/en/configuration.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("configuration"),a("OutboundLink")],1),t._v(". It detects tests within a "),t._m(71),t._v(" directory it also happens to capture the naming pattern the project is using by default:")]),t._m(72),t._m(73),t._m(74),a("p",[t._v("Given generating coverage reports comes with a performance overhead, enabling the behavior through the flag can be a good idea. This way you can control exactly when to capture the information.")]),a("p",[t._v("Porting a webpack setup to Jest requires more effort especially if you rely on webpack specific features. "),a("a",{attrs:{href:"https://facebook.github.io/jest/docs/en/webpack.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("The official guide"),a("OutboundLink")],1),t._v(" covers quite a few of the common problems. You can also configure Jest to use Babel through "),a("a",{attrs:{href:"https://www.npmjs.com/package/babel-jest",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-jest"),a("OutboundLink")],1),t._v(" as it allows you to use Babel plugins like "),a("a",{attrs:{href:"https://www.npmjs.com/package/babel-plugin-module-resolver",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-plugin-module-resolver"),a("OutboundLink")],1),t._v(" to match webpack's functionality.")]),a("p",[t._v("T> "),a("a",{attrs:{href:"https://www.npmjs.com/package/jest-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("jest-webpack"),a("OutboundLink")],1),t._v(" provides an integration between webpack and Jest.")]),t._m(75),t._m(76),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/ava",target:"_blank",rel:"noopener noreferrer"}},[t._v("AVA"),a("OutboundLink")],1),t._v(" is a test runner that has been designed to take advantage of parallel execution. It comes with a test suite definition of its own. "),a("a",{attrs:{href:"https://github.com/greyepoxy/webpack-ava-recipe",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-ava-recipe"),a("OutboundLink")],1),t._v(" covers how to connect it with webpack.")]),t._m(77),t._m(78),a("p",[t._v("Mocking is a technique that allows you to replace test objects. Consider the solutions below:")]),a("ul",[a("li",[a("a",{attrs:{href:"https://www.npmjs.com/package/sinon",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sinon"),a("OutboundLink")],1),t._v(" provides mocks, stubs, and spies. It works well with webpack since version 2.0.")]),a("li",[a("a",{attrs:{href:"https://www.npmjs.com/package/inject-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("inject-loader"),a("OutboundLink")],1),t._v(" allows you to inject code into modules through their dependencies making it valuable for mocking.")]),a("li",[a("a",{attrs:{href:"https://www.npmjs.com/package/rewire-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("rewire-webpack"),a("OutboundLink")],1),t._v(" allows mocking and overriding module globals. "),a("a",{attrs:{href:"https://www.npmjs.com/package/babel-plugin-rewire",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-plugin-rewire"),a("OutboundLink")],1),t._v(" implements "),a("a",{attrs:{href:"https://www.npmjs.com/package/rewire",target:"_blank",rel:"noopener noreferrer"}},[t._v("rewire"),a("OutboundLink")],1),t._v(" for Babel.")])]),t._m(79),t._m(80),t._m(81),a("p",[t._v("{pagebreak}")]),t._m(82),a("p",[t._v("Webpack can be configured to work with a large variety of testing tools. Each tool has its sweet spots, but they also have quite a bit of common ground.")]),a("p",[t._v("To recap:")]),t._m(83),a("p",[t._v("You'll learn to deploy applications using webpack in the next chapter.")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"testing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testing","aria-hidden":"true"}},[this._v("#")]),this._v(" Testing")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("You can "),s("strong",[this._v("unit test")]),this._v(" a specific piece of code, or you can look at the application from the user's point of view through "),s("strong",[this._v("acceptance testing")]),this._v(". "),s("strong",[this._v("Integration testing")]),this._v(" fits between these ends of the spectrum and is concerned about how separate units of code operate together.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mocha"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mocha","aria-hidden":"true"}},[this._v("#")]),this._v(" Mocha")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/mocha.png",alt:"Mocha"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"configuring-mocha-loader-with-webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-mocha-loader-with-webpack","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuring "),s("em",[this._v("mocha-loader")]),this._v(" with Webpack")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("To get started, include Mocha and "),s("em",[this._v("mocha-loader")]),this._v(" to your project:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" mocha mocha-loader --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"setting-up-code-to-test"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-code-to-test","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting Up Code to Test")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("tests/add.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("module"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" a "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("tests/add.test.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" assert "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"assert"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" add "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./add"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token function"}},[t._v("describe")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Demo"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("it")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"should add correctly"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    assert"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("equal")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("add")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"configuring-mocha"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-mocha","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuring Mocha")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:mocha"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"mocha tests"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute "),s("code",[this._v("npm run test:mocha")]),this._v(" now, you should see the following output:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("Demo\n  should add correctly\n\n\n1 passing (5ms)\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Mocha also provides a watch mode which you can activate through "),s("code",[this._v("npm run test:mocha -- --watch")]),this._v(". It runs the test suite as you modify the code.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> "),s("code",[this._v("--grep <pattern>")]),this._v(" can be used for constraining the behavior if you want to focus only on a particular set of tests.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"configuring-webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuring-webpack","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuring Webpack")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("To tell webpack which tests to run, they need to be imported somehow. The "),s("em",[this._v("Dynamic Loading")]),this._v(" chapter discussed "),s("code",[this._v("require.context")]),this._v(" that allows to aggregate files based on a rule. It's ideal here. Set up an entry point as follows:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("tests/index.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// Skip execution in Node")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" context "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("context")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{attrs:{class:"token string"}},[t._v('"mocha-loader!./"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Process through mocha-loader")]),t._v("\n    "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Skip recursive processing")]),t._v("\n    "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("\\"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js$"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Pick only files ending with .test.js")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{attrs:{class:"token comment"}},[t._v("// Execute each test suite")]),t._v("\n  context"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("keys")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("forEach")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("webpack.mocha.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"path"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" merge "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"webpack-merge"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" parts "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./webpack.parts"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  parts"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("devServer")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  parts"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("page")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Mocha demo"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    entry"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      tests"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" path"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("join")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"tests"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> See the "),s("em",[this._v("Composing Configuration")]),this._v(" chapter for the full "),s("code",[this._v("devServer")]),this._v(" setup. The page setup is explained in the "),s("em",[this._v("Multiple Pages")]),this._v(" chapter.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:mocha:watch"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),a("span",{attrs:{class:"token string"}},[t._v('"webpack-dev-server --hot --config webpack.mocha.js"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> If you want to understand what "),s("code",[this._v("--hot")]),this._v(" does better, see the "),s("em",[this._v("Hot Module Replacement")]),this._v(" appendix.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute the server now and navigate to "),s("code",[this._v("http://localhost:8080/")]),this._v(", you should see the test:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/mocha-browser.png",alt:"Mocha in browser"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("It's possible to adjust module resolution. Webpack aliasing and other techniques work now, but this would also tie the code to webpack.")]),s("li",[this._v("You can use webpack's processing to compile your code as you wish. With vanilla Mocha that would imply more setup outside of it.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("On the downside, now you need a browser to examine the tests. "),s("em",[this._v("mocha-loader")]),this._v(" is at its best as a development helper. The problem can be solved by running the tests through a headless browser.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"karma-and-mocha"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#karma-and-mocha","aria-hidden":"true"}},[this._v("#")]),this._v(" Karma and Mocha")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/karma.png",alt:"Karma"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("To get started, install Karma, Mocha, "),s("em",[this._v("karma-mocha")]),this._v(" reporter, and "),s("em",[this._v("karma-webpack")]),this._v(":")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" karma mocha karma-mocha karma-webpack --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("karma.conf.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" parts "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./webpack.parts"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" config "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tests "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"tests/*.test.js"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  config"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    frameworks"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"mocha"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    files"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        pattern"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tests"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    preprocessors"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tests"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"webpack"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    webpack"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" parts"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("loadJavaScript")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    singleRun"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:karma"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"karma start"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n...\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute "),s("code",[this._v("npm run test:karma")]),this._v(" now, you should see the terminal output:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("...\nwebpack: Compiled successfully.\n...:INFO [karma]: Karma v1.7.1 server started at http://0.0.0.0:9876/\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The above means Karma is waiting and you have to visit that url to run the tests. As per configuration ("),s("code",[this._v("singleRun: true")]),this._v("), Karma terminates execution after that:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("...\n...:INFO [karma]: Karma v1.7.1 server started at http://0.0.0.0:9876/\n...:INFO [Chrome 61...]: Connected on socket D...A with id manual-73\nChrome 61...): Executed 1 of 1 SUCCESS (0.003 secs / 0 secs)\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> You can point Karma to specific browsers through the "),s("code",[this._v("browsers")]),this._v(" field. Example: "),s("code",[this._v("browsers: ['Chrome']")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"running-tests-through-phantomjs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-tests-through-phantomjs","aria-hidden":"true"}},[this._v("#")]),this._v(" Running Tests Through PhantomJS")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" karma-phantomjs-launcher phantomjs-prebuilt --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("karma.conf.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("module"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" config "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\n  config"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    browsers"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"PhantomJS"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute the tests again ("),s("code",[this._v("npm run test:karma")]),this._v("), you should get output without having to visit an url:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("...\nwebpack: Compiled successfully.\n...:INFO [karma]: Karma v1.7.1 server started at http://0.0.0.0:9876/\n...:INFO [launcher]: Launching browser PhantomJS with unlimited concurrency\n...:INFO [launcher]: Starting browser PhantomJS\n...:INFO [PhantomJS ...]: Connected on socket 7...A with id 123\nPhantomJS ...: Executed 1 of 1 SUCCESS (0.005 secs / 0.001 secs)\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"watch-mode-with-karma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watch-mode-with-karma","aria-hidden":"true"}},[this._v("#")]),this._v(" Watch Mode with Karma")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:karma:watch"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"karma start --auto-watch --no-single-run"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute "),s("code",[this._v("npm run test:karma:watch")]),this._v(" now, you should see watch behavior.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"generating-coverage-reports"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generating-coverage-reports","aria-hidden":"true"}},[this._v("#")]),this._v(" Generating Coverage Reports")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("npm install babel-plugin-istanbul karma-coverage --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v(".babelrc")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{attrs:{class:"token property"}},[t._v('"env"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"karma"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token property"}},[t._v('"plugins"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{attrs:{class:"token string"}},[t._v('"istanbul"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{attrs:{class:"token property"}},[t._v('"exclude"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"tests/*.test.js"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("karma.conf.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("module"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" config "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\n  process"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("BABEL_ENV")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"karma"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  config"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> If you want to understand the "),s("code",[this._v("env")]),this._v(" idea, see the "),s("em",[this._v("Loading JavaScript")]),this._v(" chapter.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("On Karma side, reporting has to be set up, and Karma configuration has to be connected with webpack. "),s("em",[this._v("karma-webpack")]),this._v(" provides two fields for this purpose: "),s("code",[this._v("webpack")]),this._v(" and "),s("code",[this._v("webpackMiddleware")]),this._v(". You should use the former in this case to make sure the code gets processed through Babel.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("karma.conf.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"path"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" config "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\n  config"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    reporters"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v('"coverage"')]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    coverageReporter"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      dir"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"build"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      reporters"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"html"')]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"lcov"')]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("T> If you want to emit the reports to specific directories below "),s("code",[this._v("dir")]),this._v(", set "),s("code",[this._v("subdir")]),this._v(" per each report.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute karma now ("),s("code",[this._v("npm run test:karma")]),this._v("), you should see a new directory below "),s("em",[this._v("build")]),this._v(" containing coverage reports. The HTML report can be examined through the browser.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/coverage.png",alt:"Coverage in browser"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"jest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jest","aria-hidden":"true"}},[this._v("#")]),this._v(" Jest")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/jest.png",alt:"Jest"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("npm install jest --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("em",[s("strong",[this._v("tests")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:jest:watch"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"jest --watch"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"test:jest"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"jest"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ...\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("Now you have two new commands: one to run tests once and other to run them in a watch mode. To capture coverage information, you have to set "),a("code",[t._v('"collectCoverage": true')]),t._v(" at "),a("code",[t._v('"jest"')]),t._v(" settings in "),a("em",[t._v("package.json")]),t._v(" or pass "),a("code",[t._v("--coverage")]),t._v(" flag to Jest. It emits the coverage reports below "),a("em",[t._v("coverage")]),t._v(" directory by default.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"ava"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ava","aria-hidden":"true"}},[this._v("#")]),this._v(" AVA")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"images/ava.png",alt:"AVA"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The main idea is to run both webpack and AVA in watch mode to push the problem of processing code to webpack while allowing AVA to consume the processed code. The "),s("code",[this._v("require.context")]),this._v(" idea discussed with Mocha comes in handy here as you have to capture tests for webpack to handle somehow.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mocking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mocking","aria-hidden":"true"}},[this._v("#")]),this._v(" Mocking")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"removing-files-from-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#removing-files-from-tests","aria-hidden":"true"}},[this._v("#")]),this._v(" Removing Files From Tests")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you execute tests through webpack, you may want to alter the way it treats assets like images. You can match them and then use a "),s("code",[this._v("noop")]),this._v(" function to replace the modules as follows:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("plugins"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("webpack"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NormalModuleReplacementPlugin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{attrs:{class:"token regex"}},[t._v("/\\.(gif|png|scss|css)$/")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"lodash/noop"')]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"conclusion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#conclusion","aria-hidden":"true"}},[this._v("#")]),this._v(" Conclusion")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Running testing tools allows you to benefit from webpack's module resolution mechanism.")]),s("li",[this._v("Sometimes the test setup can be quite involved. Tools like Jest remove most of the boilerplate and allow you to develop tests with minimal configuration.")]),s("li",[this._v("You can find multiple mocking tools for webpack. They allow you to shape test environment. Sometimes you can avoid mocking through design, though.")])])}],!1,null,null,null);e.options.__file="04_testing.md";s.default=e.exports}}]);