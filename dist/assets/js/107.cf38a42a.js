(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{261:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web worker"),a("OutboundLink")],1),t._v(" 允许你将工作移到到JavaScript的主执行线程之外，这使得它们便于进行冗长的计算和后台工作。")]),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),a("p",[t._v("你可以使用内联loader定义来做一个示例演示，而不是将loader序定义推送到webpack配置。有关替代方案的更多信息，请参阅 "),a("a",{attrs:{href:"https://lvzhenbang.github.io/webpack-book/dist/zh/loading/01_loader_definitions.html",target:"_blank",rel:"noopener noreferrer"}},[a("em",[t._v("Loader 的基本定义")]),a("OutboundLink")],1),t._v(" 这章内容。")]),t._m(8),a("p",[t._v("worker必须做两件事：听取消息并做出回应。在这两个动作之间，它可以执行计算。在这种情况下，你接受文本数据，将其附加到自身，然后发送结果：")]),t._m(9),t._m(10),t._m(11),a("p",[t._v("Host须是worker的一个实例，然后与worker通信。除了host拥有控制功能之外，其它几乎相同")]),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),a("p",[t._v("你最需要注意的是worker无法访问DOM。你可以在worker程序中执行计算和查询，但它无法直接操作用户界面。")]),a("p",[t._v("内容回顾：")]),t._m(17),a("p",[t._v("在下一章中，将详细的介绍如何用webpack做国际化处理。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"web-workers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-workers","aria-hidden":"true"}},[this._v("#")]),this._v(" Web Workers")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在主线程和工作线程之间移动数据会带来与通信相关的开销。拆分提供了隔离，迫使 "),s("code",[this._v("web worker")]),this._v(" 只关注逻辑，因为它们无法直接操作用户界面。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("web worker")]),this._v(" 的想法在一般化的层面上是有价值的。 [parallel-webpack]（https://www.npmjs.com/package/parallel-webpack）使用底层的 [worker-farm]（https://www.npmjs.com/package/worker-farm）并行化webpack执行。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("正如 "),s("em",[this._v("Build Targets")]),this._v(" 章节中所讨论的，webpack允许你将应用程序构建为工作程序本身。为了更好地了解 "),s("code",[this._v("web worker")]),this._v("，你可以学习如何使用[worker-loader]（https://www.npmjs.com/package/worker-loader）构建一个微型的worker。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("由于[SharedArrayBuffer]（https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer）等技术，将来主机和worker之间的数据共享可能会变得更加容易。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"创建-worker-loader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建-worker-loader","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建 "),s("code",[this._v("Worker Loader")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("首先，在项目中安装 "),s("em",[this._v("worker-loader")]),this._v(" ：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" worker-loader --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"配置一个worker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置一个worker","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置一个Worker")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("src/worker.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("self"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  self"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("postMessage")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" text "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" text "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"创建一个host"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建一个host","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建一个Host")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("src/component.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Worker "),a("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"worker-loader!./worker"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("createElement")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"h1"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" worker "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Worker")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"foo"')]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  worker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"message"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" state"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  element"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" worker"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("postMessage")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" state"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" element"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("有host和worker这两个后，"),s("code",[this._v("web worker")]),this._v(" 才可以工作。当你单击文本时，它应该在worker完成其执行时,改变应用程序状态。为了演示worker的异步特性，你可以尝试在代码中添加延迟，然后查看会发生什么。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("[webworkify-webpack]（https://www.npmjs.com/package/webworkify-webpack）是 "),s("em",[this._v("worker-loader")]),this._v(" 的替代方案。 API允许你将worker用作常规JavaScript模块，同时避免在示例解决方案中看到 "),s("code",[this._v("self")]),this._v("。[webpack-worker]（https://www.npmjs.com/package/webpack-worker）是另一个研究学习的选择。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Web worker允许你将工作移出到浏览器的主线程之外。如果一个项目需要性能问题，这种分离是有意义的。")]),s("li",[this._v("Web worker无法操纵DOM。 相反，最好将它们用于冗长的计算和请求。")]),s("li",[this._v("Web worker提供的隔离可以使架构受益。它迫使程序员留在特定的沙箱中。")]),s("li",[this._v("与Web worker进行通信会产生开销，使其不太实用。随着规范的发展，这可能会在未来发生变化。")])])}],!1,null,null,null);e.options.__file="02_web_workers.md";s.default=e.exports}}]);