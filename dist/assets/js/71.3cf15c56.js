(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{212:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),a("p",[t._v("尽管webpack还没有做太多的工作，但是配置的规模逐渐变大。现在，你需要注意组合它的方式，因为你在项目中有独立的生产和开发目标。当你希望向项目添加更多功能时，情况只会变得更糟。")]),a("p",[t._v("使用单一的配置文件会影响理解，并消除任何可重用性的潜力。随着项目需求的增长，你将必须找到更有效地管理webpack配置的方法。")]),t._m(1),a("p",[t._v("你可以使用下面一些方法管理webpack配置：")]),a("ul",[t._m(2),a("li",[t._v("将配置存放到库中，然后使用它。如："),a("a",{attrs:{href:"https://www.npmjs.com/package/hjs-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("hjs-webpack"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://neutrino.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Neutrino"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://www.npmjs.com/package/webpack-blocks",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-blocks"),a("OutboundLink")],1),t._v(".")]),a("li",[t._v("将配置存放到工具中。如："),a("a",{attrs:{href:"https://www.npmjs.com/package/create-react-app",target:"_blank",rel:"noopener noreferrer"}},[t._v("create-react-app"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://www.npmjs.com/package/kyt",target:"_blank",rel:"noopener noreferrer"}},[t._v("kyt"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://www.npmjs.com/package/nwb",target:"_blank",rel:"noopener noreferrer"}},[t._v("nwb"),a("OutboundLink")],1),t._v(".")]),t._m(3)]),a("p",[t._v("可以将这些方法组合起来使用，从而创建一个高级的配置，这个配置由更小的部分组成；然后将这些部分添加到一个库中；最后通过npm使用这个库，从而可以跨多个项目使用相同的配置。")]),t._m(4),a("p",[t._v("如果配置文件被分解成单独的部分，它们必须以某种方式重新组合。通常这意味着合并对象和数组。"),a("a",{attrs:{href:"https://www.npmjs.org/package/webpack-merge",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-merge"),a("OutboundLink")],1),t._v("被开发出来解决 "),a("code",[t._v("Object.assign")]),t._v(" 和 "),a("code",[t._v("Array.concat")]),t._v(" 存在的问题。")]),t._m(5),t._m(6),t._m(7),t._m(8),a("blockquote",[a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/webpack-chain",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-chain"),a("OutboundLink")],1),t._v(" 提供一个流畅的API来配置webpack。通常，在你尝试在项目之间共享这些对象配置，并尝试后期对其进行修改时，这是比较麻烦的事儿，因为你需要深入的了解这些被修改的对象的底层结构，但是 "),a("code",[t._v("webpack-chain")]),t._v(" 就是为了解决这个问题而开发的。")])]),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),a("blockquote",[a("p",[t._v("同样 "),a("code",[t._v("stats")]),t._v(" 思想也适用于生产模式的配置。 参考 "),a("a",{attrs:{href:"https://webpack.js.org/configuration/stats/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1),t._v(" 可以查看所有可用的选项。")])]),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),a("p",[t._v("在做了这些更改之后，构建的行为应该与以前一样。然而，这一次你将拥有对配置扩展的空间，你不不用担心如何实现不同部分配置的组合。")]),t._m(21),t._m(22),a("blockquote",[a("p",[t._v("在Node中，"),a("a",{attrs:{href:"https://nodejs.org/api/process.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("process"),a("OutboundLink")],1),t._v(" 模块是一个暴露的全局变量。除了 "),a("code",[t._v("env")]),t._v(" ，它还提供了许多其它的功能，这些功能可以让用户更方便地获得主机系统信息。")])]),t._m(23),t._m(24),t._m(25),t._m(26),a("p",[t._v("现在，在配置中你将接受一个对象（"),a("code",[t._v('{ target: "production" }')]),t._v("），而不是接受一个字符串。你也可以添加更多的键值对，它们最终将被被传递到 "),a("code",[t._v("env")]),t._v(" 对象。如果你在npm脚本中使用了 "),a("code",[t._v("--env foo")]),t._v("，而不是"),a("code",[t._v("--env.target")]),t._v(" 的格式，那么在配置中将得到字符串。webpack依赖于 "),a("a",{attrs:{href:"http://yargs.js.org/docs/#parsing-tricks-dot-notation",target:"_blank",rel:"noopener noreferrer"}},[t._v("yargs"),a("OutboundLink")],1),t._v(" 实现底层的解析。")]),t._m(27),a("p",[t._v("配置分割可以让你轻松的扩展配置。最重要的好处是你可以提取不同目标之间的相同撇脂。你还可以确定要组成最终配置的最小配置单元，将这些配置单元单独保存在一个文件中，就可以跨项目使用。")]),a("p",[t._v("现在，你可以将配置当作依赖项进行管理，而不是在不同的项目之间重复类似的配置。当你找到实现某些功能的更好解决方案时，你所有的项目都将得到改进。")]),a("p",[t._v("每种方案都有其优缺点。它虽然提供了组合配置的功能，但它带给了你查看配置代码的不便。因此查看其他人是如何做的，对自己也是有很好的帮助。不管怎么说，你可以根据自己的喜好找到最有效的方案。")]),a("p",[t._v("对于合成配置来说，也许最大的问题是，你需要知道你在做什么，但是你不会在第一次组合完成的时候就得到答案，这是一个超越webpack的软件工程问题。")]),a("p",[t._v("You can always iterate on the interfaces and find better ones. By passing in a configuration object instead of multiple arguments you can change the behavior of a part without affecting its API, effectively exposing the API as you need it.")]),t._m(28),t._m(29),t._m(30),a("p",[t._v("如果你根据目标将配置进行拆分，那么最终你会得到如下所示的配置文件结构：")]),t._m(31),t._m(32),t._m(33),t._m(34),t._m(35),a("p",[t._v("这样你就可以到相关的配置目录中快速的找到配置信息。一个好的推荐方案就是将各个部分的配置都放在一个文件中，然后用注释将他们分割开来。")]),t._m(36),a("p",[t._v("由于所有的配置都是JavaScript，所以你可以将它们当作一个NPM包（package）来使用。你可以将共享配置做成一个NPM包，然后你就可以跨项目的使用。具体实现可参考 "),a("a",{attrs:{href:"https://resourvejs.com/maintenance/",target:"_blank",rel:"noopener noreferrer"}},[t._v("survival - Maintenance"),a("OutboundLink")],1),t._v(" 这本书。")]),t._m(37),a("p",[t._v("虽然配置在技术上与以前相同，但你仍然有空间来扩展它。")]),a("p",[t._v("内容回顾：")]),a("ul",[a("li",[t._v("因为webpack的底层实现是JavaScript，所以你可以有很多方法来管理他。")]),a("li",[t._v("你可以用 "),a("a",{attrs:{href:"https://www.npmjs.com/package/webpack-merge",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-merge"),a("OutboundLink")],1),t._v(" 来实现配置的合并。")]),t._m(38),a("li",[t._v("组合可以支持配置共享。你不必维护每个项目自定义配置，而是可以共享配置。使用npm包可以做到这一点。")])]),t._m(39)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"组合配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 组合配置")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"管理配置的一些方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#管理配置的一些方法","aria-hidden":"true"}},[this._v("#")]),this._v(" 管理配置的一些方法")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("为每个环境（env）维护一个配置文件，通过 "),s("code",[this._v("--config")]),this._v(" 参数配置文件传递给webpack，通过模块导入的方式共享配置。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("维护单个文件中的所有配置，然后依赖 "),s("code",[this._v("--env")]),this._v(" 参数。本章稍后将详细讲解这种方法。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"组合配置——合并"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合配置——合并","aria-hidden":"true"}},[this._v("#")]),this._v(" 组合配置——合并")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("webpack-merge")]),this._v(" 做了两件事：它时拼接数组和对象，而不是重载它们而实现组合的目的。下面距离说明：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" merge "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"webpack-merge"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" merge"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a: "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", b: 5, c: 20 "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a: "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("2"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", b: 10, d: 421 "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a: "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" 1, 2 "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", b: 10, c: 20, d: 421 "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("webpack-merge")]),this._v(" 提供了很多的控制方法，使你可以控制每个字段，它们允许你实现目标内部的前面添加(prepend)，目标内部的后边添加（append），目标内容替换（replace）的目的。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("虽然 "),s("em",[this._v("webpack-merge")]),this._v(" 是专门为wepack而设计的，但事实证明它是一种非常有价值的工具。你可以把它当作一个学习工具，如果你觉得它方便的话，你可以在工作中学习它。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"引入-webpack-merge"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引入-webpack-merge","aria-hidden":"true"}},[this._v("#")]),this._v(" 引入 "),s("em",[this._v("webpack-merge")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("首先，添加 "),s("em",[this._v("webpack-merge")]),this._v(" 依赖：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),s("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" webpack-merge --save-dev\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("为了实现一定程度的抽象，你可以定义 "),s("em",[this._v("webpack.config.js")]),this._v(" 文件来写入高级的配置，定义 "),s("em",[this._v("webpack.parts.js")]),this._v(" 存放通用的配置。下面提供了一个从现有配置代码中抽象出来的函数形式的接口：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("webpack.parts.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("exports"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("devServer")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" host"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" port "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  devServer"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stats"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"errors-only"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    host"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Defaults to `localhost`")]),t._v("\n    port"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Defaults to 8080")]),t._v("\n    open"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    overlay"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在 "),s("em",[this._v("webpack.config.js")]),this._v(" 中引入 "),s("em",[this._v("webpack.parts.js")]),this._v(" :")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("webpack.config.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" merge "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"webpack-merge"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" HtmlWebpackPlugin "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"html-webpack-plugin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" parts "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./webpack.parts"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" commonConfig "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    plugins"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("HtmlWebpackPlugin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        title"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Webpack demo"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" productionConfig "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" developmentConfig "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  parts"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("devServer")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Customize host/port here if needed")]),t._v("\n    host"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" process"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("HOST")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    port"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" process"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token constant"}},[t._v("PORT")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mode "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mode "),a("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"production"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("commonConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" productionConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" mode "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("merge")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("commonConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" developmentConfig"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" mode "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("代替直接返回配置，而是一个函数（process）捕获传递的 "),s("code",[this._v("env")]),this._v(" 参数被返回，然后把它返回配置，并将webpack "),s("code",[this._v("mode")]),this._v(" 映射到它。这样意味着"),s("em",[this._v("package.json")]),this._v(" 需要做如下修改:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  // "),a("span",{attrs:{class:"token property"}},[t._v('"start"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack-dev-server --mode development"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  // "),a("span",{attrs:{class:"token property"}},[t._v('"build"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack --mode production"')]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"start"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack-dev-server --env development"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"build"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack --env production"')]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("你可以通过扩展"),s("em",[this._v("package.json")]),this._v("定义来添加更多的目标。随着 * webpack.parts。js* 包含更多的特定功能的技术，然后你可以使用组合配置，然后合并到 "),s("em",[this._v("webpack.config。js")]),this._v(" 中。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("productionConfig")]),this._v(" 随着我们进一步扩展配置，它将逐步增长.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"理解-env"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#理解-env","aria-hidden":"true"}},[this._v("#")]),this._v(" 理解 "),s("code",[this._v("--env")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("虽然利用 "),s("code",[this._v("--env")]),this._v(" 可以向配置中传递一个字符串，但它可以做的更多，如下面所示：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"start"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack-dev-server --env development"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"build"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"webpack --env.target production"')]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"组合配置的好处"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合配置的好处","aria-hidden":"true"}},[this._v("#")]),this._v(" 组合配置的好处")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"配置的框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置的框架","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置的框架")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在这本书中，你的所有配置被放在 "),s("em",[this._v("webpack.config.js")]),this._v(" 和 "),s("em",[this._v("webpack.parts.js")]),this._v(" 文件中：前者包含一些高级的配置，后者则包含一些基础的、细节化的配置。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"根据目标拆分配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#根据目标拆分配置文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 根据目标拆分配置文件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[this._v(".")]),this._v("\n└── config\n    ├── webpack.common.js\n    ├── webpack.development.js\n    ├── webpack.parts.js\n    └── webpack.production.js\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在这个例子中，你可以通过webpack的 "),s("code",[this._v("--config")]),this._v(" 参数指向目标，用 "),s("code",[this._v("merge")]),this._v(" 来合并配置，如： "),s("code",[this._v("module.exports = merge(common, config);")]),this._v(" 。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"根据不同的目的分离parts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#根据不同的目的分离parts","aria-hidden":"true"}},[this._v("#")]),this._v(" 根据不同的目的分离Parts")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("为了实现配置功能的模块化管理，可以引入层次结构。你可以将 "),s("em",[this._v("webpack.parts.js")]),this._v(" 拆分如下：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[this._v(".")]),this._v("\n└── config\n    ├── parts\n    │   ├── devserver.js\n    "),s("span",{attrs:{class:"token punctuation"}},[this._v("..")]),this._v(".\n    │   ├── index.js\n    │   └── javascript.js\n    └── "),s("span",{attrs:{class:"token punctuation"}},[this._v("..")]),this._v(".\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"将配置做成npm包-package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将配置做成npm包-package","aria-hidden":"true"}},[this._v("#")]),this._v(" 将配置做成NPM包(package)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("通过在终端使用 "),s("code",[this._v("--env")]),this._v(" 参数，你可以向webpack传递构建的目标。在webpack中你可以使用Node的Process 模块来接受 "),s("code",[this._v("env")]),this._v(" 传递的字符串或对象。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("本书的下一部分将介绍不同的技术，因此 "),s("em",[this._v("webpack.parts.js")]),this._v(" 文件中将增加很多代码块。随之而来， "),s("em",[this._v("webpack.config.js")]),this._v(" 文件将做很大的修改，幸运的是它将变得更小。")])}],!1,null,null,null);e.options.__file="03_composing_configuration.md";s.default=e.exports}}]);