(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{231:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),a("blockquote",[a("p",[t._v("可以生成一个用来展示足够信息的站点，如： "),a("a",{attrs:{href:"https://github.com/antwarjs/antwar",target:"_blank",rel:"noopener noreferrer"}},[t._v("Antwar"),a("OutboundLink")],1),t._v("。")])]),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),a("p",[t._v("鉴于这里讨论的方法依赖于静态分析，webpack必须找到有问题的文件，它并不适用于所有可能的情况。 如果您需要的文件在另一台服务器上或必须通过特定端点访问，那么webpack是不够的。")]),a("p",[t._v("在这种情况下，考虑使用浏览器端loader，如：[$ script.js]（https://www.npmjs.com/package/scriptjs）或[little-loader]（https://www.npmjs.com/package/little-loader ）。")]),t._m(19),t._m(20),a("p",[t._v("内容回顾：")]),t._m(21),a("p",[t._v("在下一章中，将详细介绍在webpack中使用web workers。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"动态加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态加载","aria-hidden":"true"}},[this._v("#")]),this._v(" 动态加载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("虽然你通过学习 "),s("em",[this._v("代码分割")]),this._v(" 章节，已经了解了webpack的众多功能，但还有更多功能。Webpack通过"),s("code",[this._v("require.context")]),this._v(" 提供了许多动态处理代码的方法。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"用-require-context-实现动态加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用-require-context-实现动态加载","aria-hidden":"true"}},[this._v("#")]),this._v(" 用 "),s("code",[this._v("require.context")]),this._v(" 实现动态加载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("[require.context]（https://webpack.js.org/api/module-methods/#require-context）提供了一种代码分割的一般形式。假设你正在webpack上编写静态站点生成器。你可以通过包含Markdown文件的 "),s("code",[this._v("./ pages /")]),this._v(" 目录在目录结构中添加你的站点内容。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这些文件中的每一个都有一个用于metadata的YAML前端。可以基于文件名确定每个页面的URL并将其映射为站点。要使用 "),s("code",[this._v("require.context")]),this._v(" 对这个想法进行建模，你可能会得到如下代码：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 通过`yaml-frontmatter-loader`和`json-loader`处理页面。")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// `yaml-frontmatter-loader`转换文件中的YAML，")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("// `json-loader`将其转换为JSON结构以便稍后使用。markdown尚未处理。")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" req "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("context")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{attrs:{class:"token string"}},[t._v('"json-loader!yaml-frontmatter-loader!./pages"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Load files recursively. Pass false to skip recursion.")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("^")]),t._v("\\"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\\"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("md$"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// Match files ending with .md.")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("可以将loader定义添加到webpack配置。内联格式用于保持示例的最小化.")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("code",[t._v("require.context")]),t._v(" 返回一个函数给 "),a("code",[t._v("require")]),t._v("。它还知道它的模块 "),a("code",[t._v("id")]),t._v("，它提供了一个"),a("code",[t._v("keys（）")]),t._v(" 方法来计算上下文的内容。以下是示例代码：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("keys")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v('// ["./demo.md", "./another-demo.md"]')]),t._v("\nreq"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{attrs:{class:"token comment"}},[t._v("// 42")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v('// {title: "Demo", body: "# Demo page\\nDemo content\\n\\n"}')]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" demoPage "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("req")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"./demo.md"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("该技术可用于其他目的，如：测试或为添加webpack可监视的文件。在这种情况下，你可以在文件中设置"),s("code",[this._v("require.context")]),this._v("，然后通过 "),s("code",[this._v("webpack")]),this._v(" 的 "),s("code",[this._v("entry")]),this._v("指向该文件。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"用动态的-import-实现动态路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用动态的-import-实现动态路径","aria-hidden":"true"}},[this._v("#")]),this._v(" 用动态的 "),s("code",[this._v("import")]),this._v(" 实现动态路径")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("同样的想法适用于动态"),s("code",[this._v("import")]),this._v("。你可以传递部分路径，而不是传递完整路径。Webpack在内部设置上下文。如下面的例子：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// Set up a target or derive this somehow")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" target "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"fi"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("// Elsewhere in code")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("import")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token template-string"}},[a("span",{attrs:{class:"token string"}},[t._v("`translations/")]),a("span",{attrs:{class:"token interpolation"}},[a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("target"),a("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{attrs:{class:"token string"}},[t._v(".json`")])]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("then")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("同样的想法适用于 "),a("code",[t._v("require")]),t._v("，因为webpack可以执行静态分析。如："),a("code",[t._v("require（")]),t._v("assets/modals /${imageSrc}.js"),a("code",[t._v("）;")]),t._v(" 将生成一个上下文，并根据传递给"),a("code",[t._v("require")]),t._v("的"),a("code",[t._v("imageSrc")]),t._v("来解析图像。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("使用动态导入时，请在路径中指定文件扩展名，以便通过保持较小的上下文来提高性能。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"多个-require-context-的合并"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多个-require-context-的合并","aria-hidden":"true"}},[this._v("#")]),this._v(" 多个 "),s("code",[this._v("require.context")]),this._v(" 的合并")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("多个单独的"),s("code",[this._v("require.context")]),this._v("，可以通过将它们包装在函数后面来组合成一个：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" concat"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uniq "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("require")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"lodash"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{attrs:{class:"token function-variable function"}},[t._v("combineContexts")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("contexts"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("webpackContext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Find the first match and execute")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" matches "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" contexts\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("map")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" context"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("keys")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("indexOf")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" context"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("filter")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" a"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" matches"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" matches"),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  webpackContext"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("keys")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("uniq")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      concat"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("apply")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("null")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" contexts"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("map")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" context"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("keys")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" webpackContext"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"动态路径的处理方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态路径的处理方案","aria-hidden":"true"}},[this._v("#")]),this._v(" 动态路径的处理方案")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("尽管"),s("code",[this._v("require.context")]),this._v("是一个小众功能，但要注意它的优势。如果你必须对文件系统中可用的多个文件执行查找，它将变得很有用。如果你的查找比这更复杂，则必须使用其他允许你执行加载运行时的替代方法。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("require.context")]),t._v(" 是一个经常隐藏在幕后的高级功能。 如果必须对大量文件执行查找，请使用它。")]),a("li",[t._v("如果以某种形式编写一个动态"),a("code",[t._v("import")]),t._v("，webpack会生成一个"),a("code",[t._v("require.context")]),t._v(" 调用。在这种情况下，代码读取稍微好一些。")]),a("li",[t._v("这些技术仅适用于文件系统。如果你要对网址进行操作，则应该考虑客户端解决方案。")])])}],!1,null,null,null);e.options.__file="01_dynamic_loading.md";s.default=e.exports}}]);