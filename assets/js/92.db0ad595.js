(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{186:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._m(1),s("blockquote",[s("p",[s("code",[t._v("Tree shaking")]),t._v(" 通过"),s("a",{attrs:{href:"https://www.npmjs.com/package/webpack-common-shake",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-common-shake"),s("OutboundLink")],1),t._v("对CommonJS模块定义进行了一定程度的处理工作。由于大多数npm软件包都是使用旧版定义编写的，因此该插件具有价值。")])]),t._m(2),t._m(3),t._m(4),t._m(5),s("p",[t._v("要确保使用部分代码，请更改应用程序入口点：")]),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),s("blockquote",[s("p",[t._v("有一个 CSS 模块相关的 "),s("code",[t._v("Tree shaking")]),t._v(" loader ，如："),s("a",{attrs:{href:"https://github.com/simlrh/dead-css-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("dead-css-loader"),s("OutboundLink")],1),t._v("。")])]),t._m(11),t._m(12),t._m(13),s("p",[t._v("为了最大限度地利用外部软件包的 "),s("code",[t._v("Tree shaking")]),t._v(" ，你必须使用"),s("a",{attrs:{href:"https://www.npmjs.com/package/babel-plugin-transform-imports",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel-plugin-transform-imports"),s("OutboundLink")],1),t._v("重写导入，以便他们使用webpack的 "),s("code",[t._v("Tree shaking")]),t._v(" 逻辑。有关详细信息，请参阅"),s("a",{attrs:{href:"https://github.com/webpack/webpack/issues/2867",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack issue＃2867"),s("OutboundLink")],1),t._v("。")]),s("blockquote",[s("p",[s("a",{attrs:{href:"https://survivejs.com/maintenance/packaging/building/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SurviveJS - Maintenance"),s("OutboundLink")],1),t._v(" 介绍如何编写包，以便可以对它们应用 "),s("code",[t._v("Tree shaking")]),t._v(" 。")])]),t._m(14),t._m(15),s("p",[t._v("内容回顾：")]),t._m(16),s("p",[t._v("在下一章中，将详细的介绍如何在webpack中管理环境变量。")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"tree-shaking"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking","aria-hidden":"true"}},[this._v("#")]),this._v(" Tree Shaking")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("Tree shaking")]),this._v(" 是需要使用ES2015模块定义才能起作用的功能。你可以静态地分析模块定义而不运行它，webpack可以告诉代码的哪些部分正在使用，哪些部分没有。可以通过扩展应用程序，并在那里添加应该删除的代码来验证此行为。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"tree-shaking-demo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking-demo","aria-hidden":"true"}},[this._v("#")]),this._v(" Tree-Shaking demo")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("要 "),e("code",[this._v("Tree shaking")]),this._v(" 代码，你必须定义一个模块，并仅使用其部分代码。模块定义如下：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("src/shake.js")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{attrs:{class:"token function-variable function"}},[t._v("shake")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("log")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"shake"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{attrs:{class:"token function-variable function"}},[t._v("bake")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("log")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"bake"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" shake"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bake "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("src/index.js")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" bake "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"./shake"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token function"}},[t._v("bake")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("运行 "),s("code",[t._v("npm run build")]),t._v(" 脚本命令，然后检查构建输出 "),s("code",[t._v("dist/main.js")]),t._v("，它应该只包含 "),s("code",[t._v('console.log("bake")')]),t._v("，而没有 "),s("code",[t._v('console.log("shake")')]),t._v(" 。如果是这样，那么这个功能就实现了。")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("为了更好地了解webpack用于 "),s("code",[t._v("Tree shaking")]),t._v(" 的内容，你可以运行 "),s("code",[t._v("npm run build - --display-used-exports")]),t._v(" 脚本命令。在终端中，你看到额外的输出，如："),s("code",[t._v("[no exports used]")]),t._v(" 或 "),s("code",[t._v("[only some exports used: bake]")]),t._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("如果您使用"),e("code",[this._v("UglifyJsPlugin")]),this._v("，请启用类似效果的消息提示。除了其他消息之外，你应该看到诸如"),e("code",[this._v("Dropping unused variable treeShakingDemo [./src/component.js:17,6]")]),this._v("之类的信息。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"包级别的tree-shaking"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#包级别的tree-shaking","aria-hidden":"true"}},[this._v("#")]),this._v(" 包级别的Tree-Shaking")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("同样的想法适用于使用ES2015模块定义的依赖项。鉴于相关的包装标准仍在修订中，在使用此类包装时必须小心。由于这个原因，Webpack尝试着去解析 "),e("code",[this._v("package.json")]),this._v(" 的 "),e("code",[this._v("module")]),this._v("字段。")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("对于像webpack这样的工具来允许 "),s("code",[t._v("Tree shaking")]),t._v(" npm包，你应该创建一个构建，它已经转换了除ES2015模块定义之外的所有其他内容，然后通过 "),s("code",[t._v("package.json")]),t._v(" 的 "),s("code",[t._v("module")]),t._v(" 字段指向它。在Babel术语中，你必须通过设置 "),s("code",[t._v('"modules"：false')]),t._v(" 让webpack来管理ES2015模块。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("code",[t._v("Tree shaking")]),t._v("是一种潜在的强大技术。为了让源代码受益于"),s("code",[t._v("Tree shaking")]),t._v("，必须使用ES2015模块语法引入npm包，并且必须通过 "),s("code",[t._v("package.json")]),t._v(" 的 "),s("code",[t._v("module")]),t._v(" 的字段来公开，这样webpack可以获取到它。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("code",[this._v("Tree shaking")]),this._v(" 根据静态代码分析丢弃未使用的代码片段。Webpack在遍历依赖关系图时，为你执行此过程。")]),e("li",[this._v("要从 "),e("code",[this._v("Tree shaking")]),this._v(" 中受益，你必须使用ES2015模块定义。")]),e("li",[this._v("作为软件包(npm)作者，你可以专门提供支持ES2015模块的软件包版本，其余版本已转换为ES5")])])}],!1,null,null,null);n.options.__file="02_tree_shaking.md";e.default=n.exports}}]);