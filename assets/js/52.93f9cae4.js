(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{281:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[t._m(0),s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web workers"),s("OutboundLink")],1),t._v(" allow you to push work outside of main execution thread of JavaScript making them convenient for lengthy computations and background work.")]),s("p",[t._v("Moving data between the main thread and the worker comes with communication-related overhead. The split provides isolation that forces workers to focus on logic only as they cannot manipulate the user interface directly.")]),s("p",[t._v("The idea of workers is valuable on a more general level. "),s("a",{attrs:{href:"https://www.npmjs.com/package/parallel-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("parallel-webpack"),s("OutboundLink")],1),t._v(" uses "),s("a",{attrs:{href:"https://www.npmjs.com/package/worker-farm",target:"_blank",rel:"noopener noreferrer"}},[t._v("worker-farm"),s("OutboundLink")],1),t._v(" underneath to parallelize webpack execution.")]),s("p",[t._v("As discussed in the "),s("em",[t._v("Build Targets")]),t._v(" chapter, webpack allows you to build your application as a worker itself. To get the idea of web workers better, you'll learn how to build a small worker using "),s("a",{attrs:{href:"https://www.npmjs.com/package/worker-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("worker-loader"),s("OutboundLink")],1),t._v(".")]),s("p",[t._v("T> Sharing data between the host and the worker may become easier in the future thanks to technologies such as "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer",target:"_blank",rel:"noopener noreferrer"}},[t._v("SharedArrayBuffer"),s("OutboundLink")],1),t._v(".")]),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),s("p",[t._v("A worker has to do two things: listen to messages and respond. Between those two actions, it can perform a computation. In this case, you accept text data, append it to itself, and send the result:")]),t._m(6),t._m(7),t._m(8),s("p",[t._v("The host has to instantiate the worker and then communicate with it. The idea is almost the same except the host has the control:")]),t._m(9),t._m(10),s("p",[t._v("After you have these two set up, it should work. As you click the text, it should mutate the application state as the worker completes its execution. To demonstrate the asynchronous nature of workers, you could try adding delay to the answer and see what happens.")]),s("p",[t._v("T> "),s("a",{attrs:{href:"https://www.npmjs.com/package/webworkify-webpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("webworkify-webpack"),s("OutboundLink")],1),t._v(" is an alternative to "),s("em",[t._v("worker-loader")]),t._v(". The API allows you to use the worker as a regular JavaScript module as well given you avoid the "),s("code",[t._v("self")]),t._v(" requirement visible in the example solution. "),s("a",{attrs:{href:"https://www.npmjs.com/package/webpack-worker",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-worker"),s("OutboundLink")],1),t._v(" is another option to study.")]),t._m(11),s("p",[t._v("The critical thing to note is that the worker cannot access the DOM. You can perform computation and queries in a worker, but it cannot manipulate the user interface directly.")]),s("p",[t._v("To recap:")]),t._m(12),s("p",[t._v("You'll learn about internationalization in the next chapter.")])])},[function(){var t=this.$createElement,a=this._self._c||t;return a("h1",{attrs:{id:"web-workers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-workers","aria-hidden":"true"}},[this._v("#")]),this._v(" Web Workers")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"setting-up-worker-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-worker-loader","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting Up Worker Loader")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("To get started, install "),a("em",[this._v("worker-loader")]),this._v(" to the project:")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[this._v("npm")]),this._v(" "),a("span",{attrs:{class:"token function"}},[this._v("install")]),this._v(" worker-loader --save-dev\n")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("Instead of pushing the loader definition to webpack configuration, you can use inline loader definitions to keep the demonstration minimal. See the "),a("em",[this._v("Loader Definitions")]),this._v(" chapter for more information about the alternatives.")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"setting-up-a-worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-a-worker","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting Up a Worker")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[a("strong",[this._v("src/worker.js")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("self"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  self"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" text "),s("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" text "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"setting-up-a-host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-a-host","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting Up a Host")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[a("strong",[this._v("src/component.js")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Worker "),s("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"worker-loader!./worker"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"h1"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" worker "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Worker")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"foo"')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  worker"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"message"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    element"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  element"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" state"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  element"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" worker"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" state"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" element"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion","aria-hidden":"true"}},[this._v("#")]),this._v(" Conclusion")])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",[a("li",[this._v("Web workers allow you to push work out of the main thread of the browser. This separation is valuable especially if performance is an issue.")]),a("li",[this._v("Web workers cannot manipulate the DOM. Instead, it's best to use them for lengthy computations and requests.")]),a("li",[this._v("The isolation provided by web workers can be used for architectural benefit. It forces the programmers to stay within a specific sandbox.")]),a("li",[this._v("Communicating with web workers comes with an overhead that makes them less practical. As the specification evolves, this can change in the future.")])])}],!1,null,null,null);n.options.__file="02_web_workers.md";a.default=n.exports}}]);